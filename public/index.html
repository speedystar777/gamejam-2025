<html>

<head>
  <!-- Load TensorFlow.js -->
  <script src="https://unpkg.com/@tensorflow/tfjs"></script>
  <!-- Load Posenet -->
  <script src="https://unpkg.com/@tensorflow-models/posenet"></script>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
</head>

<body>
  <h4>TFJS & PoseNet test
    <hr />
  </h4>
  <video autoplay playsinline muted id="webcam" width="256" height="256" style="transform: scaleX(-1);"></video>
  <div id="debugPos" style="position: absolute; top: 0px; left: 0px;z-index: 3;background-color:#00ff00;
        width:8;height:8;"></div>
  <script src="./webcamSetup.js"> </script>
  <script src="./poseDetection.js"> </script>
  <script>

    class Example extends Phaser.Scene {
      preload() {
        this.load.image('sky', 'assets/orig_big.png');
        this.load.image('bubble', 'assets/bubble.svg');
      }

      create() {
        this.add.image(400, 300, 'sky');
        this.sprite = this.physics.add.image(400, 600, 'bubble').setScale(0.5);

        this.bubble = this.physics.add.image(200, 600, 'bubble').setScale(0.5);

        this.bubble.setInteractive();

        this.input.setDraggable(this.bubble);

        this.input.on('drag', (pointer, gameObject, dragX, dragY) => {

          gameObject.x = dragX;
          gameObject.y = dragY;

        });

      }

      update() {

        this.physics.overlap(this.sprite, this.bubble, (sprite, bubble) => {

          sprite.destroy();

        });
      }
    }

    const config = {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      parent: 'phaser-example',
      physics: {
        default: 'arcade',
        arcade: {
          debug: true,
          gravity: { y: -100 }
        }
      },
      scene: Example
    };

    const game = new Phaser.Game(config);

  </script>

</body>

</html>